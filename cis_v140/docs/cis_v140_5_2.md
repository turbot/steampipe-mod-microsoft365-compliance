## Description

By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.

Starting in January 2019, Microsoft is turning on mailbox audit logging by default for all organizations. This means that certain actions performed by mailbox owners, delegates, and admins are automatically logged, and the corresponding mailbox audit records will be available when you search for them in the mailbox audit log. When mailbox auditing on by default is turned on for the organization, the AuditEnabled property for affected mailboxes won't be changed from False to True. In other words, mailbox auditing on by default ignores the AuditEnabled property on mailboxes. However, only certain mailbox types support default auditing On
- User Mailboxes
- Shared Mailboxes
- Microsoft 365 Group Mailboxes

## Remediation

To enable mailbox auditing for all users, use the Exchange Online PowerShell Module:

1. Run Microsoft Exchange Online PowerShell Module.
2. Connect using `Connect-EXOPSSession`.
3. Run the following PowerShell commands:

```bash
$AuditAdmin = @("Copy", "Create", "FolderBind","HardDelete", "MessageBind", "Move", "MoveToDeletedItems", "SendAs","SendOnBehalf", "SoftDelete", "Update", "UpdateCalendarDelegation","UpdateFolderPermissions", "UpdateInboxRules")

$AuditDelegate = @("Create", "FolderBind", "HardDelete", "Move", "MoveToDeletedItems", "SendAs", "SendOnBehalf","SoftDelete", "Update", "UpdateFolderPermissions", "UpdateInboxRules")

$AdminOwner = @("Create", "HardDelete", "MailboxLogin", "Move", "MoveToDeletedItems", "SoftDelete", "Update","UpdateCalendarDelegation","UpdateFolderPermissions", "UpdateInboxRules")

Get-Mailbox -ResultSize Unlimited | Set-Mailbox -AuditEnabled $true -AuditLogAgeLimit 180 -AuditAdmin $AuditAdmin -AuditDelegate $AuditDelegate -AuditOwner $AuditOwner
```

**Default Value:**

Only certain mailbox types support default auditing On:
1. User Mailboxes
2. Shared Mailboxes
3. Microsoft 365 Group Mailboxes

The remaining mailbox types require auditing be turned on at the mailbox level:
1. Resource Mailboxes
2. Public Folder Mailboxes
3. DiscoverySearch Mailbox
