## Description

Non-privileged users can create tenants in the Azure AD and Entra administration portal under Manage tenant. The creation of a tenant is recorded in the Audit log as category DirectoryManagement and activity Create Company. Anyone who creates a tenant becomes the Global Administrator of that tenant. The newly created tenant doesn't inherit any settings or configurations.

Restricting tenant creation prevents unauthorized or uncontrolled deployment of resources and ensures that the organization retains control over its infrastructure. User generation of shadow IT could lead to multiple, disjointed environments that can make it difficult for IT to manage and secure the organization's data, especially if other users in the organization began using these tenants for business purposes under the misunderstanding that they were secured by the organization's security team.

## Remediation
Restrict access to the Azure AD portal:

1. Navigate to `Microsoft Entra admin center` https://aad.portal.azure.com/.
2. Click to expand `Azure Active Directory`.
3. Select `Users` then `User settings`.
4. Set Tenant creation `Restrict non-admin users from creating tenants (preview)` to `Yes` then `Save`.

To remediate using PowerShell:

1. Connect to Microsoft Graph using Connect-MgGraph -Scopes "Policy.ReadWrite.Authorization".
2. Run the following commands.

```bash
# allowedToCreateTenants is only available in beta Select-MgProfile -Name beta
# Create object params hashtable
$params = @{
        DefaultUserRolePermissions = @{
               AllowedToCreateTenants = $false
        }
}
# Update default authorization policy Update-MgPolicyAuthorizationPolicy -AuthorizationPolicyId 'authorizationPolicy' -BodyParameter $params
```

3. Run the audit procedure to ensure `allowedToCreateTenants` is `False`.

**Default Value:** No - Non-administrators can create tenants. `AllowedToCreateTenants` is `True`.
