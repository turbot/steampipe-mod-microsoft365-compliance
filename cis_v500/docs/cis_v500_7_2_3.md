## Description

The external sharing settings govern sharing for the organization overall. Each site has its own sharing setting that can be set independently, though it must be at the same or more restrictive setting as the organization.

The new and existing guests option requires people who have received invitations to sign in with their work or school account (if their organization uses Microsoft 365) or a Microsoft account, or to provide a code to verify their identity. Users can share with guests already in your organization's directory, and they can send invitations to people who will be added to the directory if they sign in.

The recommended state is `New and existing guests` or less permissive.

## Remediation

**To remediate using the UI:**

1. Navigate to `SharePoint admin center` [https://admin.microsoft.com/sharepoint](https://admin.microsoft.com/sharepoint).
2. Click `Policies` > `Sharing`.
3. Locate the `External sharing section`.
4. Under SharePoint, move the slider bar to New and existing guests or a less permissive level.
    - OneDrive will also be moved to the same level and can never be more permissive than SharePoint.

**To remediate using PowerShell:**

1. Connect to SharePoint Online using `Connect-SPOService -Url https://[tenant]-admin.sharepoint.com`.
2. Run the following cmdlet to establish the minimum recommended state:

```bash
Set-SPOTenant -SharingCapability ExternalUserSharingOnly
```

3. To verify the setting:

```bash
Get-SPOTenant | Select-Object SharingCapability
```

**Note:** Other acceptable values for this parameter that are more restrictive include: `Disabled` and `ExistingExternalUserSharingOnly`.

### Default Value

Anyone (ExternalUserAndGuestSharing)

